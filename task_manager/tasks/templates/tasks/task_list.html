<!-- task_manager/tasks/templates/tasks/task_list.html -->

<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>タスク一覧</title>
</head>
<body>
    <h1>タスク一覧</h1>

    <!-- 検索フォーム -->
    <form method="get" action=".">
        <input type="text" name="q" placeholder="タイトル or コメント検索" value="{{ query }}">
        
        <select name="is_completed">
            <option value="">完了状態(すべて)</option>
            <option value="true" {% if is_completed == 'true' %}selected{% endif %}>完了</option>
            <option value="false" {% if is_completed == 'false' %}selected{% endif %}>未完了</option>
        </select>

        <select name="is_archived">
            <option value="">アーカイブ状態(すべて)</option>
            <option value="true" {% if is_archived == 'true' %}selected{% endif %}>アーカイブ済み</option>
            <option value="false" {% if is_archived == 'false' %}selected{% endif %}>通常タスク</option>
        </select>

        <button type="submit">検索</button>
    </form>

    <a href="{% url 'tasks:task_create' %}">新規作成</a>

    <table border="1" cellspacing="0" cellpadding="5">
        <thead>
            <tr>
                <th>タイトル</th>
                <th>状態</th>
                <th>アーカイブ</th>
                <th>作成日時</th>
                <th>更新日時</th>
            </tr>
        </thead>
        <tbody>
            {% for task in tasks %}
                <tr>
                    <td>
                        <a href="{% url 'tasks:task_detail' task.pk %}">{{ task.title }}</a>
                    </td>
                    <td>{% if task.is_completed %}完了{% else %}未完了{% endif %}</td>
                    <td>{% if task.is_archived %}済{% else %}-{% endif %}</td>
                    <td>{{ task.created_at|date:"Y-m-d H:i" }}</td>
                    <td>{{ task.updated_at|date:"Y-m-d H:i" }}</td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="5">タスクはありません</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

</body>
</html>